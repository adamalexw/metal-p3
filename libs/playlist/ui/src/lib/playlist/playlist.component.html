@if (playlist(); as playlist) {
  <div class="flex justify-center lg:hidden">
    <mat-icon (click)="hide.emit()">expand_more</mat-icon>
  </div>

  <table class="mat-elevation-z8" [dataSource]="playlist" (cdkDropListDropped)="drop($event)" mat-table cdkDropList>
    <ng-container matColumnDef="trackNumber">
      <th *matHeaderCellDef mat-header-cell>#</th>
      <td *matCellDef="let element" mat-cell>
        <span>{{ element.trackNumber }}</span>
      </td>
    </ng-container>

    <ng-container matColumnDef="title">
      <th *matHeaderCellDef class="w-2/3" mat-header-cell>Title</th>
      <td *matCellDef="let element" mat-cell>
        <span>{{ element.title }}</span>
      </td>
    </ng-container>

    <ng-container matColumnDef="artist">
      <th *matHeaderCellDef class="w-1/3" mat-header-cell>Band</th>
      <td *matCellDef="let element" mat-cell>
        <span>{{ element.artist }}</span>
      </td>
    </ng-container>

    <ng-container matColumnDef="duration">
      <th *matHeaderCellDef mat-header-cell></th>
      <td *matCellDef="let element" mat-cell>
        <div class="flex items-center gap-1">
          <span>{{ element.duration | time }}</span>
          @if (!element.playing && currentItem()?.id !== element.id) {
            <mat-icon class="cursor-pointer" (click)="removeItem.emit(element.id)">delete</mat-icon>
          }
        </div>
      </td>
    </ng-container>

    <ng-container matColumnDef="action">
      <th *matHeaderCellDef mat-header-cell></th>
      <td *matCellDef="let element" mat-cell>
        @if (element.playing) {
          <mat-icon class="cursor-pointer" (click)="pauseItem.emit()">play_arrow</mat-icon>
        }
        @if (!element.playing && currentItem()?.id === element.id) {
          <mat-icon class="cursor-pointer" (click)="resumeItem.emit()">pause</mat-icon>
        }
        @if (!element.playing && currentItem()?.id !== element.id) {
          <div class="cover relative cursor-pointer" (click)="playItem.emit(element.id)">
            <app-cover [cover]="element.cover" [width]="48" [height]="48" />
          </div>
        }
      </td>
    </ng-container>

    <tr *matHeaderRowDef="displayedColumns" mat-header-row></tr>
    <tr *matRowDef="let row; columns: displayedColumns" mat-row cdkDrag></tr>
  </table>
}
