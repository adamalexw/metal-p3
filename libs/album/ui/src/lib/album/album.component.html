<ng-container *ngIf="album">
  <nav>
    <app-album-toolbar
      [saving]="albumSaving"
      [findingUrl]="findingUrl"
      [renamingFolder]="renamingFolder"
      [trackTransferring]="trackTransferring"
      [folder]="album.folder"
      [extraFiles]="album.extraFiles || false"
      (save)="onSave()"
      (imageSearch)="onImageSearch()"
      (findUrl)="onFindUrl()"
      (renameFolder)="onRenameFolder()"
      (openFolder)="openFolder.emit({ id: albumId, folder: album.fullPath })"
      (transfer)="onTransferAlbum()"
      (delete)="deleteAlbum.emit(albumId)"
    ></app-album-toolbar>
  </nav>

  <ng-container *ngIf="trackSavingProgress || trackTransferringProgress || trackRenamingProgress as progress">
    <mat-progress-bar class="w-full" mode="determinate" [value]="progress"> </mat-progress-bar>
  </ng-container>

  <section class="flex flex-row">
    <app-cover
      class="min-w-[500px]"
      [loading]="coverLoading"
      [cover]="album.cover"
      [coverError]="album.coverError"
      [enableDnd]="true"
      [width]="500"
      [height]="500"
      (coverUrl)="coverUrl.emit({ id: album.id, url: $event })"
    ></app-cover>

    <app-album-form
      class="block w-full mx-2 mt-1 mb-0"
      [form]="form"
      (findBandProps)="findBandProps.emit({ id: albumId, url: $event })"
      (lyricsPriority)="lyricsPriority.emit(albumId)"
    ></app-album-form>
  </section>

  <section>
    <app-tracks-toolbar
      [trackRenaming]="trackRenaming || false"
      [lyricsLoading]="lyricsLoading || false"
      [enableMaActions]="!!albumUrl"
      [albumDuration]="albumDuration || 0"
      (renameTracks)="onRenameTracks()"
      (trackNumbers)="onTrackNumbers()"
      (maTracks)="onMaTracks()"
      (lyrics)="onLyrics()"
      (refreshTracks)="refreshTracks.emit({ id: album.id, folder: album.folder })"
      (playAlbum)="playAlbum.emit(this.albumId)"
      (addAlbumToPlaylist)="addAlbumToPlaylist.emit(this.albumId)"
    >
    </app-tracks-toolbar>
    <app-tracks
      [form]="form"
      [tracksLoading]="tracksLoading || false"
      [tracks]="tracks || []"
      [tracksError]="tracksError"
      (transferTrack)="onTransferTrack($event)"
      (playTrack)="playTrack.emit({ track: $event, albumId: albumId })"
      (addTrackToPlaylist)="addTrackToPlaylist.emit({ track: $event, albumId: albumId })"
      (delete)="deleteTrack.emit({ track: $event, albumId: albumId })"
    ></app-tracks>
  </section>
</ng-container>
